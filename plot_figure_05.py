import reimport globimport xarray as xrimport numpy as npimport matplotlib.pyplot as pltfrom datetime import datetimefrom pynhhd import nHHDfrom phd.variables.get_variables_manual import GetVariablesWRFfrom scipy.ndimage import rotatefile_path = '/Volumes/Samsung_T5/phd_data/2011-11-29/wrfout_d03_2011-11-29_10-00-00.nc'height = 500variables = GetVariablesWRF(file_path)lat, lon = variables.get_lat_lons()u, v = variables.get_wind_components_at_heights(height=height)grid = lat.shapespacings = (1, 1)windfield = np.stack((u, v))windfield = np.transpose(windfield, (1, 2, 0))nhhd = nHHD(grid=grid, spacings=spacings)nhhd.decompose(windfield)rot = nhhd.rdiv = nhhd.dharmonic = nhhd.hrot_u = rot[..., 0]rot_v = rot[..., 1]div_u = div[..., 0]div_v = div[..., 1]harmonic_u = harmonic[..., 0]harmonic_v = harmonic[..., 1]# Subsample data if necessaryn = 50lon_sub = lon[::n, ::n]lat_sub = lat[::n, ::n]rot_u_sub = rot_u[::n, ::n]rot_v_sub = rot_v[::n, ::n]div_u_sub = div_u[::n, ::n]div_v_sub = div_v[::n, ::n]harmonic_u_sub = harmonic_u[::n, ::n]harmonic_v_sub = harmonic_v[::n, ::n]# Create plotsfig, axs = plt.subplots(1, 3, figsize=(18, 6))# Rotational Componentaxs[0].quiver(lon_sub, lat_sub, rot_u_sub, rot_v_sub, scale=50)axs[0].set_title('Rotational Component')axs[0].set_xlabel('Longitude')axs[0].set_ylabel('Latitude')# Divergent Componentaxs[1].quiver(lon_sub, lat_sub, div_u_sub, div_v_sub, scale=50)axs[1].set_title('Divergent Component')axs[1].set_xlabel('Longitude')axs[1].set_ylabel('Latitude')# Harmonic Componentaxs[2].quiver(lon_sub, lat_sub, harmonic_u_sub, harmonic_v_sub, scale=50)axs[2].set_title('Harmonic Component')axs[2].set_xlabel('Longitude')axs[2].set_ylabel('Latitude')# Adjust layout and show plotplt.tight_layout()plt.show()